{% style %}
  .y2k-product {
    padding: 3rem 2rem;
    background: {{ section.settings.background_color }};
  }

  .y2k-product__container {
    max-width: 1400px;
    margin: 0 auto;
    display: grid;
    grid-template-columns: 1.2fr 0.8fr;
    gap: 3rem;
  }

  /* Product Images - Stacked with borders */
  .y2k-product__images {
    position: relative;
  }

  .y2k-product__main-image {
    position: relative;
    border: {{ section.settings.border_width }}px solid {{ section.settings.border_color }};
    overflow: hidden;
    margin-bottom: 1.5rem;
  }

  .y2k-product__main-image img {
    width: 100%;
    height: auto;
    display: block;
  }

  /* Image badge overlay */
  .y2k-product__badge {
    position: absolute;
    top: 1.5rem;
    right: 1.5rem;
    background: {{ section.settings.badge_bg_color }};
    color: {{ section.settings.badge_text_color }};
    padding: 0.5rem 1rem;
    border: {{ section.settings.border_width }}px solid {{ section.settings.border_color }};
    font-weight: 700;
    font-size: 0.85rem;
    text-transform: uppercase;
    letter-spacing: 0.05em;
    transform: rotate(5deg);
  }

  /* Thumbnail grid */
  .y2k-product__thumbnails {
    display: grid;
    grid-template-columns: repeat(4, 1fr);
    gap: 1rem;
  }

  .y2k-product__thumbnail {
    aspect-ratio: 1;
    border: {{ section.settings.border_width }}px solid {{ section.settings.border_color }};
    cursor: pointer;
    overflow: hidden;
    transition: transform 0.2s ease;
  }

  .y2k-product__thumbnail:hover {
    transform: scale(1.05);
  }

  .y2k-product__thumbnail img {
    width: 100%;
    height: 100%;
    object-fit: cover;
  }

  /* Product Info - Window style */
  .y2k-product__info {
    position: sticky;
    top: 2rem;
    height: fit-content;
  }

  .y2k-product__window {
    background: {{ section.settings.window_bg_color }};
    border: {{ section.settings.border_width }}px solid {{ section.settings.border_color }};
  }

  /* Window titlebar */
  .y2k-product__titlebar {
    background: {{ section.settings.titlebar_bg_color }};
    padding: 0.75rem 1rem;
    border-bottom: {{ section.settings.border_width }}px solid {{ section.settings.border_color }};
    display: flex;
    align-items: center;
    gap: 0.5rem;
  }

  .y2k-product__dots {
    display: flex;
    gap: 0.4rem;
  }

  .y2k-product__dot {
    width: 12px;
    height: 12px;
    border-radius: 50%;
    border: {{ section.settings.border_width }}px solid {{ section.settings.border_color }};
  }

  .y2k-product__dot--red { background: #ff5f56; }
  .y2k-product__dot--yellow { background: #ffbd2e; }
  .y2k-product__dot--green { background: #27c93f; }

  .y2k-product__window-title {
    font-size: 0.85rem;
    font-weight: 600;
    color: {{ section.settings.text_color }};
    flex: 1;
  }

  /* Window content */
  .y2k-product__content {
    padding: 2rem;
  }

  .y2k-product__title {
    font-size: clamp(1.8rem, 3vw, 2.5rem);
    font-weight: 700;
    color: {{ section.settings.text_color }};
    margin-bottom: 1rem;
    line-height: 1.2;
  }

  .y2k-product__price {
    font-size: 1.5rem;
    font-weight: 700;
    color: {{ section.settings.text_color }};
    margin-bottom: 1.5rem;
    padding: 0.75rem 1rem;
    background: {{ section.settings.price_bg_color }};
    border: {{ section.settings.border_width }}px solid {{ section.settings.border_color }};
    display: inline-block;
  }

  .y2k-product__description {
    font-size: 1rem;
    color: {{ section.settings.text_color }};
    line-height: 1.6;
    opacity: 0.85;
    margin-bottom: 2rem;
    padding-bottom: 2rem;
    border-bottom: {{ section.settings.border_width }}px solid {{ section.settings.border_color }};
  }

  /* Variant selector */
  .y2k-product__variants {
    margin-bottom: 2rem;
  }

  .y2k-product__variant-label {
    font-size: 0.9rem;
    font-weight: 600;
    text-transform: uppercase;
    letter-spacing: 0.05em;
    margin-bottom: 0.75rem;
    color: {{ section.settings.text_color }};
  }

  .y2k-product__variant-options {
    display: flex;
    flex-wrap: wrap;
    gap: 0.75rem;
  }

  .y2k-product__variant-option {
    padding: 0.75rem 1.5rem;
    border: {{ section.settings.border_width }}px solid {{ section.settings.border_color }};
    background: {{ section.settings.window_bg_color }};
    cursor: pointer;
    font-weight: 500;
    transition: all 0.2s ease;
  }

  .y2k-product__variant-option:hover {
    background: {{ section.settings.border_color }};
    color: {{ section.settings.window_bg_color }};
  }

  .y2k-product__variant-option.active {
    background: {{ section.settings.button_bg_color }};
    color: {{ section.settings.button_text_color }};
  }

  /* Add to cart button */
  .y2k-product__add-to-cart {
    width: 100%;
    padding: 1.25rem 2rem;
    background: {{ section.settings.button_bg_color }};
    color: {{ section.settings.button_text_color }};
    border: {{ section.settings.border_width }}px solid {{ section.settings.border_color }};
    font-weight: 700;
    font-size: 1.1rem;
    text-transform: uppercase;
    letter-spacing: 0.05em;
    cursor: pointer;
    transition: all 0.2s ease;
    position: relative;
  }

  .y2k-product__add-to-cart::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: {{ section.settings.border_color }};
    transform: translate(4px, 4px);
    z-index: -1;
    transition: transform 0.2s ease;
  }

  .y2k-product__add-to-cart:hover::before {
    transform: translate(6px, 6px);
  }

  @media (max-width: 1024px) {
    .y2k-product__container {
      grid-template-columns: 1fr;
      gap: 2rem;
    }

    .y2k-product__info {
      position: relative;
      top: 0;
    }
  }

  @media (max-width: 768px) {
    .y2k-product__content {
      padding: 1.5rem;
    }

    .y2k-product__thumbnails {
      grid-template-columns: repeat(3, 1fr);
    }
  }
{% endstyle %}

<section class="y2k-product">
  <div class="y2k-product__container">
    <!-- Product Images -->
    <div class="y2k-product__images">
      <div class="y2k-product__main-image">
        {% if product.featured_image %}
          <img 
            src="{{ product.featured_image | image_url: width: 1200 }}"
            alt="{{ product.featured_image.alt | escape }}"
            id="y2k-main-image"
          >
        {% endif %}
        
        {% if product.tags contains 'new' or product.tags contains 'sale' %}
          <div class="y2k-product__badge">
            {% if product.tags contains 'sale' %}SALE{% else %}NEW{% endif %}
          </div>
        {% endif %}
      </div>

      {% if product.images.size > 1 %}
        <div class="y2k-product__thumbnails">
          {% for image in product.images limit: 4 %}
            <div class="y2k-product__thumbnail" onclick="changeMainImage('{{ image | image_url: width: 1200 }}')">
              <img 
                src="{{ image | image_url: width: 300 }}"
                alt="{{ image.alt | escape }}"
              >
            </div>
          {% endfor %}
        </div>
      {% endif %}
    </div>

    <!-- Product Info Window -->
    <div class="y2k-product__info">
      <div class="y2k-product__window">
        <div class="y2k-product__titlebar">
          <div class="y2k-product__dots">
            <span class="y2k-product__dot y2k-product__dot--red"></span>
            <span class="y2k-product__dot y2k-product__dot--yellow"></span>
            <span class="y2k-product__dot y2k-product__dot--green"></span>
          </div>
          <span class="y2k-product__window-title">product_info.window</span>
        </div>

        <div class="y2k-product__content">
          <h1 class="y2k-product__title">{{ product.title }}</h1>
          
          <div class="y2k-product__price">
            {{ product.price | money }}
          </div>

          {% if product.description %}
            <div class="y2k-product__description">
              {{ product.description }}
            </div>
          {% endif %}

          <!-- Variants -->
          {% if product.variants.size > 1 %}
            <div class="y2k-product__variants">
              <div class="y2k-product__variant-label">Select Size</div>
              <div class="y2k-product__variant-options">
                {% for variant in product.variants %}
                  <div class="y2k-product__variant-option" onclick="selectVariant({{ variant.id }})">
                    {{ variant.title }}
                  </div>
                {% endfor %}
              </div>
            </div>
          {% endif %}

          <button class="y2k-product__add-to-cart" onclick="addToCart()">
            Add to Cart
          </button>
        </div>
      </div>
    </div>
  </div>
</section>

<script>
  function changeMainImage(url) {
    document.getElementById('y2k-main-image').src = url;
  }

  function selectVariant(variantId) {
    // Remove active class from all options
    document.querySelectorAll('.y2k-product__variant-option').forEach(el => {
      el.classList.remove('active');
    });
    // Add active class to clicked option
    event.target.classList.add('active');
    // Store selected variant
    window.selectedVariant = variantId;
  }

  function addToCart() {
    const variantId = window.selectedVariant || {{ product.variants.first.id }};
    
    fetch('/cart/add.js', {
      method: 'POST',
      headers: {
        'Content-Type': 'application/json',
      },
      body: JSON.stringify({
        id: variantId,
        quantity: 1
      })
    })
    .then(response => response.json())
    .then(data => {
      // Refresh cart or show notification
      window.location.href = '/cart';
    });
  }
</script>

{% schema %}
{
  "name": "Y2K Product",
  "settings": [
    {
      "type": "header",
      "content": "Colors"
    },
    {
      "type": "color",
      "id": "background_color",
      "label": "Background",
      "default": "#f5f5f5"
    },
    {
      "type": "color",
      "id": "window_bg_color",
      "label": "Window Background",
      "default": "#ffffff"
    },
    {
      "type": "color",
      "id": "titlebar_bg_color",
      "label": "Titlebar Background",
      "default": "#e0e0e0"
    },
    {
      "type": "color",
      "id": "text_color",
      "label": "Text Color",
      "default": "#000000"
    },
    {
      "type": "color",
      "id": "border_color",
      "label": "Border Color",
      "default": "#000000"
    },
    {
      "type": "color",
      "id": "price_bg_color",
      "label": "Price Background",
      "default": "#f0f0f0"
    },
    {
      "type": "color",
      "id": "badge_bg_color",
      "label": "Badge Background",
      "default": "#ff0000"
    },
    {
      "type": "color",
      "id": "badge_text_color",
      "label": "Badge Text",
      "default": "#ffffff"
    },
    {
      "type": "color",
      "id": "button_bg_color",
      "label": "Button Background",
      "default": "#000000"
    },
    {
      "type": "color",
      "id": "button_text_color",
      "label": "Button Text",
      "default": "#ffffff"
    },
    {
      "type": "range",
      "id": "border_width",
      "min": 1,
      "max": 5,
      "step": 1,
      "default": 2,
      "label": "Border Width"
    }
  ]
}
{% endschema %}
